<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday Sreynith Ra! üéÇ üéà</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root { --primary: #facc15; --bg: #0f172a; }

body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: var(--bg);
  color: #e5e7eb;
  text-align: center;
  overflow: hidden;
  height: 100vh;
  user-select: none;
}

/* Gift Screen */
#giftScreen {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: radial-gradient(circle, #1e293b 0%, #0f172a 100%);
  z-index: 200;
  cursor: pointer;
}
.gift {
  font-size: 120px;
  animation: pulse 1.5s infinite ease-in-out;
}
@keyframes pulse {
  0%,100% { transform: scale(1); }
  50% { transform: scale(1.1) rotate(5deg); }
}

/* Main Content */
#content {
  display: none;
  height: 100vh;
  width: 100%;
  align-items: center;
  justify-content: center;
}

.card-container {
  padding: 25px;
  background-image: url('test.jpg');
  background-size: cover;
  background-position: center;
  border-radius: 45px;
  box-shadow: 0 10px 60px rgba(0,0,0,0.8);
}

.card {
  background: rgba(0,0,0,0.7);
  border-radius: 35px;
  padding: 30px 20px;
  max-width: 380px;
}

h1 {
  font-family: 'Dancing Script', cursive;
  color: var(--primary);
  font-size: 2.5rem;
  margin: 5px 0;
}
h2 {
  font-weight: 300;
  margin: 6px 0;
  font-size: 1.1rem;
}

/* Cake */
.cake-wrapper {
  position: relative;
  display: inline-block;
  cursor: pointer;
  margin: 15px 0;
}
#cake {
  font-size: 100px;
  animation: bounce 2s infinite;
}
@keyframes bounce {
  50% { transform: translateY(-10px); }
}
#flame {
  position: absolute;
  top: -35px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 45px;
  animation: flicker 0.3s infinite alternate;
}
@keyframes flicker {
  from { opacity: 0.8; }
  to { opacity: 1; transform: translateX(-50%) scale(1.15); }
}
.flame-off { display: none; }

/* Wish Text */
.wishing-text {
  display: none;
  margin-top: 15px;
  font-style: italic;
  animation: fadeIn 1s forwards;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Balloons */
.balloon {
  position: absolute;
  bottom: -120px;
  width: 60px;
  height: 85px;
  border-radius: 50%;
  cursor: crosshair;
}
.balloon::after {
  content: "";
  position: absolute;
  bottom: -12px;
  left: 50%;
  width: 2px;
  height: 25px;
  background: rgba(255,255,255,0.6);
}
.balloon-popped {
  animation: popExplosion 0.3s forwards;
}
@keyframes popExplosion {
  0% { transform: scale(1); }
  100% { transform: scale(0); opacity: 0; }
}

/* Score */
#scoreBoard {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 10px 20px;
  background: rgba(255,255,255,0.15);
  border-radius: 25px;
  font-weight: bold;
  color: var(--primary);
  display: none;
}

/* Music Control */
.controls {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(0,0,0,0.6);
  padding: 8px 12px;
  border-radius: 30px;
}
input[type=range] {
  accent-color: var(--primary);
}
</style>
</head>

<body>

<audio id="music" loop>
  <source src="happy-birthday-357371.mp3" type="audio/mp3">
</audio>

<audio id="popSound">
  <source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3" type="audio/mp3">
</audio>

<div class="controls">
  üéµ <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.5">
</div>

<div id="scoreBoard">Score: 0 üéà</div>

<div id="giftScreen" onclick="openGift()">
  <div class="gift">üéÅ</div>
  <p>A gift for <b>Sreynith Ra</b></p>
  <small>(Tap to open)</small>
</div>

<div id="content">
  <div class="card-container">
    <div class="card">

      <div class="cake-wrapper" onclick="blowCandle()">
        <div id="flame">üî•</div>
        <div id="cake">üéÇ</div>
      </div>

      <h1>Happy Birthday</h1>
      <h2>Sreynith Ra</h2>

      <h2>
        Happy Birthday! May your day be filled with gentle smiles,
        warm laughter, and beautiful moments that stay in your heart forever.
      </h2>

      <div id="wishMessage" class="wishing-text">
        <p>"Wishing you happiness, good health, and endless joy."</p>
        <p style="color:var(--primary)">‚Äî Pop the balloons üéà</p>
      </div>

      <p id="instruction" style="opacity:0.7">
        Blow into your mic or tap the cake üé§
      </p>

    </div>
  </div>
</div>

<script>
let blown = false;
let score = 0;

const music = document.getElementById("music");
const popSound = document.getElementById("popSound");
const scoreBoard = document.getElementById("scoreBoard");

function openGift() {
  document.getElementById("giftScreen").style.display = "none";
  document.getElementById("content").style.display = "flex";
  music.play().catch(()=>{});
  startMic();
}

function blowCandle() {
  if (blown) return;
  blown = true;

  music.pause();
  document.getElementById("flame").classList.add("flame-off");
  document.getElementById("instruction").style.display = "none";
  document.getElementById("wishMessage").style.display = "block";
  scoreBoard.style.display = "block";

  setInterval(createBalloon, 700);
}

function createBalloon() {
  const b = document.createElement("div");
  b.className = "balloon";
  const colors = ['#ff5e57','#0be881','#3c40c6','#ffd32a'];
  b.style.background = colors[Math.floor(Math.random()*colors.length)];
  b.style.left = Math.random()*85 + "vw";

  b.onclick = () => {
    popSound.cloneNode(true).play();
    score++;
    scoreBoard.textContent = `Score: ${score} üéà`;
    b.classList.add("balloon-popped");
    setTimeout(()=>b.remove(),300);
  };

  document.body.appendChild(b);

  let pos = -120;
  const speed = Math.random()*1.5 + 1;
  const fly = setInterval(()=>{
    pos += speed;
    b.style.bottom = pos + "px";
    if (pos > innerHeight+150) {
      clearInterval(fly);
      b.remove();
    }
  },16);
}

function startMic() {
  navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
    const ctx = new AudioContext();
    const mic = ctx.createMediaStreamSource(stream);
    const analyser = ctx.createAnalyser();
    mic.connect(analyser);
    const data = new Uint8Array(analyser.frequencyBinCount);

    function listen(){
      analyser.getByteFrequencyData(data);
      const vol = data.reduce((a,b)=>a+b)/data.length;
      if (vol > 55 && !blown) blowCandle();
      if (!blown) requestAnimationFrame(listen);
    }
    listen();
  }).catch(()=>{});
}

document.getElementById("volumeSlider").oninput = e => {
  music.volume = e.target.value;
};
</script>

</body>
</html>
